// File: /usr/lib/firefox/mozilla.cfg
//
// My Firefox settings
// defaultPref();  // set new default value
// pref();         // set pref, but allow changes in current session
// lockPref();     // lock pref, disallow changes


//
// Privacy
////////////////////////////////////////////////////////////////////////////////

// enable built-in tracking protection
lockPref('privacy.trackingprotection.enabled', true);

// enable DNT header
lockPref('privacy.donottrackheader.enabled', true);

// Lets sites know when you leave, used for Analytics
lockPref('beacon.enabled', false);

// disables sensor API (can be used for tracking)
lockPref('device.sensors.enabled', false);

// disables battery API (can be used for tracking)
// was supposedly removed, but the pref still appears to be set on new installs
// https://www.bleepingcomputer.com/news/software/battery-status-api-being-removed-from-firefox-due-to-privacy-concerns/
lockPref('dom.battery.enabled', false)

// seriously?
lockPref('camera.control.face_detection.enabled', false)

// prevent calling home
lockPref('datareporting.policy.dataSubmissionEnabled', false);
lockPref('datareporting.healthreport.uploadEnabled', false);
lockPref('toolkit.telemetry.enabled', false);
lockPref('toolkit.telemetry.server', '');
lockPref('toolkit.telemetry.cachedClientID', '');
lockPref('toolkit.telemetry.archive.enabled', false);

// disable access to the clipboard
// breaks features / causes annoyances on some sites like gmail
pref('dom.event.clipboardevents.enable', false);

// disable geo-location
lockPref('geo.enabled', false);
lockPref('geo.wifi.uri', '');
lockPref('browser.search.geoSpecificDefaults', false);

// WebRTC, leaks your IP address if behind a proxy/vpn
lockPref('media.peerconnection.enabled', false);

// disable pre-fetching
lockPref('network.prefetch-next', false)

// disable history suggestions in the address bar
lockPref('browser.urlbar.suggest.history', false);


//
// Privacy: referrer Headers
// these tend to break poorly coded sites
////////////////////////////////////////////////////////////////////////////////

// sent the target page as the referrer
pref('network.http.referer.spoofSource', true);

// send referrer only if base domain matches
pref('network.http.referer.XOriginPolicy', 1);

// referrer sends everything but the path
pref('network.http.referer.trimmingPolicy', 2);

// send referrer only on clicked links
pref('network.http.sendRefererHeader', 1);


//
// Tweaks
////////////////////////////////////////////////////////////////////////////////

// pipelining
pref('network.http.pipelining', true);
pref('network.http.pipelining.ssl', true);
pref('network.http.proxy.pipelining', true);

// Number of pages to store in a tab's history
// too many increases memory use
pref('browser.sessionhistory.max_entries', 10);
pref('sessionhistory.max_total_viewers', 10);

// enable HTTP cache
pref('browser.cache.use_new_backend', 1);

// enable Electrolysis
pref('browser.tabs.remote.autostart', true);

// Stop popups from plugins like Flash
lockPref('privacy.popups.disable_from_plugins', 2);

// prevent annoying 'Are you sure you want to leave this page' JS notices
lockPref('dom.disable_beforeunload', true);

// disable 'Allow Fullscreen' notice
pref('full-screen-api.warning.timeout', 0);

// remove extension countdown install timer
lockPref('security.dialog_enable_delay', 0);


//
// De-bloating
////////////////////////////////////////////////////////////////////////////////

// Pocket - interesting sidenote: it's basically a pre-installed extension
lockPref('extensions.pocket.enabled', false);
lockPref('extensions.pocket.api', '');
lockPref('extensions.pocket.site', '');
lockPref('extensions.pocket.oAuthConsumerKey', '');

// Reader View
lockPref('reader.parse-on-load.enabled', false);

// social crap
lockPref('social.directories', '');
lockPref('social.remote-install.enabled', false);
lockPref('social.shareDirectory', '');
lockPref('social.share.activationPanelEnabled', false);
lockPref('social.toast-notifications.enabled', false);
lockPref('social.whitelist', '');

// Advertising tiles in new tabs... who the hell wants this!?
lockPref('browser.newtabpage.enhanced', false);
lockPref('browser.newtabpage.directory.ping', '');
lockPref('browser.newtabpage.directory.source', '');

// Location bar advertising, not as bad, but still...
lockPref('browser.aboutHomeSnippets.updateUrl', '');


//
// Personal Settings
////////////////////////////////////////////////////////////////////////////////

// external source editor
pref('view_source.editor.external', true);
pref('view_source.editor.path', '/usr/bin/atom');

// disable IPv6 because my ISP sucks
pref('network.dns.disableIPv6', true);

// disable DNS prefetching since I run a local DNS caching server
pref('network.dns.disablePrefetch', true);
pref('network.dnsCacheExpiration', 0);

// Allow magnet protocol to be opened with an application
pref('network.protocol-handler.expose.magnet', false);

// Make spellchecker work everywhere
pref('layout.spellcheckDefault', 2);
pref('ui.SpellCheckerUnderlineStyle', 4);
